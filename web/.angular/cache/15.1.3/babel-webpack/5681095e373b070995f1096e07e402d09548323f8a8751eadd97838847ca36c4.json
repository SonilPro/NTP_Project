{"ast":null,"code":"import { Subject } from 'rxjs';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../api-provider.service\";\nexport class PostsService {\n  constructor(apiProvider) {\n    this.apiProvider = apiProvider;\n    this.posts = [];\n    this.postsSubject = new Subject();\n  }\n  getPosts() {\n    this.apiProvider.getPosts().subscribe(res, any => {\n      this.posts = res;\n      this.postsSubject.next([...this.posts]);\n    });\n    return this.postsSubject;\n  }\n  addPost(post) {\n    post.timestamp = new Date();\n    this.apiProvider.addPost(post).subscribe(res => {\n      this.posts.push({\n        ...post,\n        id: res.name\n      });\n      this.postsSubject.next([...this.posts]);\n    });\n  }\n  editPost(post) {\n    this.apiProvider.editPost(post).subscribe(res => {\n      this.posts[this.posts.findIndex(p => p.id == post.id)] = post;\n      this.postsSubject.next([...this.posts]);\n    });\n  }\n  deletePost(id) {\n    this.apiProvider.deletePost(id).subscribe(res => {\n      this.posts = this.posts.filter(post => post.id != id);\n      this.postsSubject.next([...this.posts]);\n    });\n  }\n}\nPostsService.ɵfac = function PostsService_Factory(t) {\n  return new (t || PostsService)(i0.ɵɵinject(i1.ApiProviderService));\n};\nPostsService.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n  token: PostsService,\n  factory: PostsService.ɵfac,\n  providedIn: 'root'\n});","map":{"version":3,"mappings":"AAGA,SAASA,OAAO,QAAQ,MAAM;;;AAM9B,OAAM,MAAOC,YAAY;EAIvBC,YAAoBC,WAA+B;IAA/B,gBAAW,GAAXA,WAAW;IAH/B,UAAK,GAAW,EAAE;IAClB,iBAAY,GAAoB,IAAIH,OAAO,EAAU;EAEC;EAE/CI,QAAQ;IACb,IAAI,CAACD,WAAW,CAACC,QAAQ,EAAE,CAACC,SAAS,CAACC,GAAG,EAAEC,GAAG,IAAG;MAC/C,IAAI,CAACC,KAAK,GAAGF,GAAa;MAC1B,IAAI,CAACG,YAAY,CAACC,IAAI,CAAC,CAAC,GAAG,IAAI,CAACF,KAAK,CAAC,CAAC;IACzC,CAAC,CAAC;IACF,OAAO,IAAI,CAACC,YAAY;EAC1B;EAEOE,OAAO,CAACC,IAAU;IACvBA,IAAI,CAACC,SAAS,GAAG,IAAIC,IAAI,EAAE;IAC3B,IAAI,CAACX,WAAW,CAACQ,OAAO,CAACC,IAAI,CAAC,CAACP,SAAS,CAAEC,GAAQ,IAAI;MACpD,IAAI,CAACE,KAAK,CAACO,IAAI,CAAC;QAAE,GAAGH,IAAI;QAAEI,EAAE,EAAEV,GAAG,CAACW;MAAI,CAAC,CAAC;MACzC,IAAI,CAACR,YAAY,CAACC,IAAI,CAAC,CAAC,GAAG,IAAI,CAACF,KAAK,CAAC,CAAC;IACzC,CAAC,CAAC;EACJ;EAEOU,QAAQ,CAACN,IAAU;IACxB,IAAI,CAACT,WAAW,CAACe,QAAQ,CAACN,IAAI,CAAC,CAACP,SAAS,CAAEC,GAAQ,IAAI;MACrD,IAAI,CAACE,KAAK,CAAC,IAAI,CAACA,KAAK,CAACW,SAAS,CAACC,CAAC,IAAIA,CAAC,CAACJ,EAAE,IAAIJ,IAAI,CAACI,EAAE,CAAC,CAAC,GAAGJ,IAAI;MAC7D,IAAI,CAACH,YAAY,CAACC,IAAI,CAAC,CAAC,GAAG,IAAI,CAACF,KAAK,CAAC,CAAC;IACzC,CAAC,CAAC;EACJ;EAEOa,UAAU,CAACL,EAAU;IAC1B,IAAI,CAACb,WAAW,CAACkB,UAAU,CAACL,EAAE,CAAC,CAACX,SAAS,CAAEC,GAAG,IAAI;MAChD,IAAI,CAACE,KAAK,GAAG,IAAI,CAACA,KAAK,CAACc,MAAM,CAAEV,IAAI,IAAKA,IAAI,CAACI,EAAE,IAAIA,EAAE,CAAC;MACvD,IAAI,CAACP,YAAY,CAACC,IAAI,CAAC,CAAC,GAAG,IAAI,CAACF,KAAK,CAAC,CAAC;IACzC,CAAC,CAAC;EACJ;;AAlCWP,YAAY;mBAAZA,YAAY;AAAA;AAAZA,YAAY;SAAZA,YAAY;EAAAsB,SAAZtB,YAAY;EAAAuB,YAFX;AAAM","names":["Subject","PostsService","constructor","apiProvider","getPosts","subscribe","res","any","posts","postsSubject","next","addPost","post","timestamp","Date","push","id","name","editPost","findIndex","p","deletePost","filter","factory","providedIn"],"sourceRoot":"","sources":["C:\\Users\\Antonio Ereiz\\Desktop\\lab\\web\\src\\app\\posts\\posts.service.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\r\nimport { ApiProviderService } from '../api-provider.service';\r\nimport { Post } from './post.model';\r\nimport { Subject } from 'rxjs';\r\nimport { AuthService } from '../auth/auth.service';\r\n\r\n@Injectable({\r\n  providedIn: 'root',\r\n})\r\nexport class PostsService {\r\n  posts: Post[] = [];\r\n  postsSubject: Subject<Post[]> = new Subject<Post[]>();\r\n\r\n  constructor(private apiProvider: ApiProviderService) {}\r\n\r\n  public getPosts() {\r\n    this.apiProvider.getPosts().subscribe(res: any => {\r\n      this.posts = res as Post[];\r\n      this.postsSubject.next([...this.posts]);\r\n    });\r\n    return this.postsSubject;\r\n  }\r\n\r\n  public addPost(post: Post) {\r\n    post.timestamp = new Date();\r\n    this.apiProvider.addPost(post).subscribe((res: any) => {\r\n      this.posts.push({ ...post, id: res.name});\r\n      this.postsSubject.next([...this.posts]);\r\n    });\r\n  }\r\n\r\n  public editPost(post: Post) {\r\n    this.apiProvider.editPost(post).subscribe((res: any) => {\r\n      this.posts[this.posts.findIndex(p => p.id == post.id)] = post;\r\n      this.postsSubject.next([...this.posts]);\r\n    });\r\n  }\r\n\r\n  public deletePost(id: String) {\r\n    this.apiProvider.deletePost(id).subscribe((res) => {\r\n      this.posts = this.posts.filter((post) => post.id != id);\r\n      this.postsSubject.next([...this.posts]);\r\n    });\r\n  }\r\n}\r\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}