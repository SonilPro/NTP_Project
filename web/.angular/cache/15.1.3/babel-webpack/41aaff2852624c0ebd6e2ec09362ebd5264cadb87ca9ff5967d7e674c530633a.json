{"ast":null,"code":"import { Subject } from 'rxjs';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../api-provider.service\";\nexport class PostsService {\n  constructor(apiProvider) {\n    this.apiProvider = apiProvider;\n    this.posts = [];\n    this.postsSubject = new Subject();\n  }\n  getPosts() {\n    this.apiProvider.getPosts().subscribe(res => {\n      this.posts = res;\n      this.postsSubject.next([...this.posts]);\n    });\n    return this.postsSubject;\n  }\n  addPost(post) {\n    post.timestamp = new Date();\n    this.apiProvider.addPost(post).subscribe(res => {\n      console.log(res);\n      this.posts.push({\n        ...post,\n        id: res.name\n      });\n      this.postsSubject.next([...this.posts]);\n    });\n  }\n  editPost(post) {\n    this.apiProvider.editPost(post).subscribe(res => {\n      this.posts[this.posts.findIndex(p => p.id == post.id)] = post;\n      this.postsSubject.next([...this.posts]);\n    });\n  }\n  deletePost(id) {\n    this.apiProvider.deletePost(id).subscribe(res => {\n      this.posts = this.posts.filter(post => post.id != id);\n      this.postsSubject.next([...this.posts]);\n    });\n  }\n}\nPostsService.ɵfac = function PostsService_Factory(t) {\n  return new (t || PostsService)(i0.ɵɵinject(i1.ApiProviderService));\n};\nPostsService.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n  token: PostsService,\n  factory: PostsService.ɵfac,\n  providedIn: 'root'\n});","map":{"version":3,"mappings":"AAGA,SAASA,OAAO,QAAQ,MAAM;;;AAM9B,OAAM,MAAOC,YAAY;EAIvBC,YAAoBC,WAA+B;IAA/B,gBAAW,GAAXA,WAAW;IAH/B,UAAK,GAAW,EAAE;IAClB,iBAAY,GAAoB,IAAIH,OAAO,EAAU;EAEC;EAE/CI,QAAQ;IACb,IAAI,CAACD,WAAW,CAACC,QAAQ,EAAE,CAACC,SAAS,CAACC,GAAG,IAAG;MAC1C,IAAI,CAACC,KAAK,GAAGD,GAAa;MAC1B,IAAI,CAACE,YAAY,CAACC,IAAI,CAAC,CAAC,GAAG,IAAI,CAACF,KAAK,CAAC,CAAC;IACzC,CAAC,CAAC;IACF,OAAO,IAAI,CAACC,YAAY;EAC1B;EAEOE,OAAO,CAACC,IAAU;IACvBA,IAAI,CAACC,SAAS,GAAG,IAAIC,IAAI,EAAE;IAC3B,IAAI,CAACV,WAAW,CAACO,OAAO,CAACC,IAAI,CAAC,CAACN,SAAS,CAAEC,GAAQ,IAAI;MACpDQ,OAAO,CAACC,GAAG,CAACT,GAAG,CAAC;MAChB,IAAI,CAACC,KAAK,CAACS,IAAI,CAAC;QAAE,GAAGL,IAAI;QAAEM,EAAE,EAAEX,GAAG,CAACY;MAAI,CAAC,CAAC;MACzC,IAAI,CAACV,YAAY,CAACC,IAAI,CAAC,CAAC,GAAG,IAAI,CAACF,KAAK,CAAC,CAAC;IACzC,CAAC,CAAC;EACJ;EAEOY,QAAQ,CAACR,IAAU;IACxB,IAAI,CAACR,WAAW,CAACgB,QAAQ,CAACR,IAAI,CAAC,CAACN,SAAS,CAAEC,GAAQ,IAAI;MACrD,IAAI,CAACC,KAAK,CAAC,IAAI,CAACA,KAAK,CAACa,SAAS,CAACC,CAAC,IAAIA,CAAC,CAACJ,EAAE,IAAIN,IAAI,CAACM,EAAE,CAAC,CAAC,GAAGN,IAAI;MAC7D,IAAI,CAACH,YAAY,CAACC,IAAI,CAAC,CAAC,GAAG,IAAI,CAACF,KAAK,CAAC,CAAC;IACzC,CAAC,CAAC;EACJ;EAEOe,UAAU,CAACL,EAAU;IAC1B,IAAI,CAACd,WAAW,CAACmB,UAAU,CAACL,EAAE,CAAC,CAACZ,SAAS,CAAEC,GAAG,IAAI;MAChD,IAAI,CAACC,KAAK,GAAG,IAAI,CAACA,KAAK,CAACgB,MAAM,CAAEZ,IAAI,IAAKA,IAAI,CAACM,EAAE,IAAIA,EAAE,CAAC;MACvD,IAAI,CAACT,YAAY,CAACC,IAAI,CAAC,CAAC,GAAG,IAAI,CAACF,KAAK,CAAC,CAAC;IACzC,CAAC,CAAC;EACJ;;AAnCWN,YAAY;mBAAZA,YAAY;AAAA;AAAZA,YAAY;SAAZA,YAAY;EAAAuB,SAAZvB,YAAY;EAAAwB,YAFX;AAAM","names":["Subject","PostsService","constructor","apiProvider","getPosts","subscribe","res","posts","postsSubject","next","addPost","post","timestamp","Date","console","log","push","id","name","editPost","findIndex","p","deletePost","filter","factory","providedIn"],"sourceRoot":"","sources":["C:\\Users\\Antonio Ereiz\\Desktop\\lab\\web\\src\\app\\posts\\posts.service.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\r\nimport { ApiProviderService } from '../api-provider.service';\r\nimport { Post } from './post.model';\r\nimport { Subject } from 'rxjs';\r\nimport { AuthService } from '../auth/auth.service';\r\n\r\n@Injectable({\r\n  providedIn: 'root',\r\n})\r\nexport class PostsService {\r\n  posts: Post[] = [];\r\n  postsSubject: Subject<Post[]> = new Subject<Post[]>();\r\n\r\n  constructor(private apiProvider: ApiProviderService) {}\r\n\r\n  public getPosts() {\r\n    this.apiProvider.getPosts().subscribe(res => {\r\n      this.posts = res as Post[];\r\n      this.postsSubject.next([...this.posts]);\r\n    });\r\n    return this.postsSubject;\r\n  }\r\n\r\n  public addPost(post: Post) {\r\n    post.timestamp = new Date();\r\n    this.apiProvider.addPost(post).subscribe((res: any) => {\r\n      console.log(res);\r\n      this.posts.push({ ...post, id: res.name});\r\n      this.postsSubject.next([...this.posts]);\r\n    });\r\n  }\r\n\r\n  public editPost(post: Post) {\r\n    this.apiProvider.editPost(post).subscribe((res: any) => {\r\n      this.posts[this.posts.findIndex(p => p.id == post.id)] = post;\r\n      this.postsSubject.next([...this.posts]);\r\n    });\r\n  }\r\n\r\n  public deletePost(id: String) {\r\n    this.apiProvider.deletePost(id).subscribe((res) => {\r\n      this.posts = this.posts.filter((post) => post.id != id);\r\n      this.postsSubject.next([...this.posts]);\r\n    });\r\n  }\r\n}\r\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}